<div class="capture-container fade-in-up">
  <h2 class="gradient-text page-title">Captura 2D - ValidaÃ§Ã£o Facial</h2>

  <!-- SeÃ§Ã£o de Captura de Selfie -->
  <section class="capture-section">
    <div class="selfie-container">
      <!-- Preview da selfie capturada -->
      <div class="selfie-preview" *ngIf="selfieDataUrl">
        <div class="preview-label">âœ… Selfie Capturada com Sucesso!</div>
        <div class="preview-image-wrapper">
          <img [src]="selfieDataUrl" alt="Selfie preview">
        </div>
        <button class="btn btn-secondary btn-retake" (click)="retakePhoto()">
          <span class="btn-icon">ğŸ”„</span>
          Tirar Novamente
        </button>
      </div>
      
      <!-- BotÃ£o para captura -->
      <div class="capture-trigger" *ngIf="!selfieDataUrl">
        <div class="trigger-content">
          <div class="trigger-icon">ğŸ“¸</div>
          <h3 class="trigger-title">Capturar Selfie 2D</h3>
          <p class="trigger-description">ValidaÃ§Ã£o facial bÃ¡sica com Rekognition</p>
          
          <button class="btn btn-primary btn-large" (click)="openCameraModal()">
            <span class="btn-icon">ğŸ“·</span>
            Abrir CÃ¢mera
          </button>
        </div>
      </div>
    </div>
  </section>
  
  <!-- Modal da CÃ¢mera (ReutilizÃ¡vel) -->
  <app-camera-modal
    [isOpen]="showCameraModal"
    mode="2d"
    (close)="closeCameraModal()"
    (capture)="onPhotoCaptured($event)"
  ></app-camera-modal>

  <!-- SeÃ§Ã£o de Upload de Documento -->
  <section class="document-section">
    <div class="section-header">
      <h3 class="section-title">ğŸ“„ Documento (RG/CNH)</h3>
      <span class="section-subtitle">Frente do documento</span>
    </div>
    
    <div class="document-upload">
      <label for="docInput" class="upload-label">
        <div class="upload-box" [class.has-file]="documentPreview">
          <span class="upload-icon" *ngIf="!documentPreview">ğŸ“</span>
          <span class="upload-text" *ngIf="!documentPreview">
            Clique ou arraste para fazer upload
          </span>
          <input 
            id="docInput" 
            type="file" 
            accept="image/jpeg,image/png,image/webp" 
            (change)="onDocumentSelected($event)"
            class="file-input">
        </div>
      </label>
      
      <div class="document-preview" *ngIf="documentPreview">
        <div class="preview-label">PrÃ©-visualizaÃ§Ã£o do Documento</div>
        <img [src]="documentPreview" alt="Document preview">
      </div>
    </div>
  </section>

  <!-- BotÃ£o de ValidaÃ§Ã£o -->
  <div class="validation-actions">
    <button 
      class="btn btn-large btn-primary" 
      (click)="onUploadClick()" 
      [disabled]="!canValidate() || loading">
      <span class="btn-icon" *ngIf="!loading">{{ documentFile ? 'âœ…' : 'ğŸ“¤' }}</span>
      <span *ngIf="loading" class="spinner"></span>
      {{ loading ? 'Processandoâ€¦' : (documentFile ? 'Validar Selfie + Documento' : 'Enviar Selfie') }}
    </button>
  </div>

  <!-- Resultado da ValidaÃ§Ã£o -->
  <section class="result-section" *ngIf="result">
    <div class="result-card" [class.approved]="result.status==='Approved'" [class.rejected]="result.status==='Rejected'" [class.review]="result.status==='ManualReview'">
      <div class="result-header">
        <div class="result-status">
          <span class="status-icon">
            {{ result.status === 'Approved' ? 'âœ…' : result.status === 'Rejected' ? 'âŒ' : 'ğŸ”' }}
          </span>
          <div class="status-info">
            <h3 class="status-title">Status da ValidaÃ§Ã£o</h3>
            <span class="status-badge" [class.approved]="result.status==='Approved'" [class.rejected]="result.status==='Rejected'" [class.review]="result.status==='ManualReview'">
              {{ result.status === 'Approved' ? 'Aprovado' : result.status === 'Rejected' ? 'Rejeitado' : 'RevisÃ£o Manual' }}
            </span>
          </div>
        </div>
        <div class="result-score">
          <div class="score-value">{{ result.similarityScore | number:'1.1-1' }}%</div>
          <div class="score-label">Similaridade</div>
        </div>
      </div>
      
      <div class="result-message" *ngIf="result.message">
        <p>{{ result.message }}</p>
      </div>
      
      <div class="result-images" *ngIf="selfieViewUrl || documentViewUrl">
        <div class="image-item" *ngIf="selfieViewUrl">
          <div class="image-label">Selfie Enviada</div>
          <img [src]="selfieViewUrl" alt="Selfie from S3">
        </div>
        <div class="image-item" *ngIf="documentViewUrl">
          <div class="image-label">Documento Enviado</div>
          <img [src]="documentViewUrl" alt="Document from S3">
        </div>
      </div>
    </div>
  </section>

  <!-- Mensagens de Status -->
  <div class="status-messages" *ngIf="statusMessage">
    <div class="status-message">{{ statusMessage }}</div>
  </div>

  <div class="hint-info">
    <p>Formatos aceitos: JPEG, PNG ou WEBP (atÃ© 5MB)</p>
  </div>
</div>
